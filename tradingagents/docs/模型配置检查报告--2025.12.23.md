# LangGraph èŠ‚ç‚¹ LLM é…ç½®æ£€æŸ¥æŠ¥å‘Š

## æ£€æŸ¥æ—¶é—´
2025å¹´12æœˆ23æ—¥æ£€æŸ¥

## æ£€æŸ¥èŒƒå›´
æ£€æŸ¥ langgraph ä¸­æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦ä½¿ç”¨å…¨å±€æ¨¡å‹é…ç½®å‚æ•°ï¼ˆ`llm_provider`ã€`deep_think_llm`ã€`quick_think_llm`ï¼‰æ¥é€‰æ‹©å¯¹åº”çš„æ¨¡å‹æœåŠ¡å¹³å°å’Œå¯¹åº”çš„æ¨¡å‹ã€‚

---

## 1. LLM åˆå§‹åŒ–æµç¨‹

### 1.1 é…ç½®å‚æ•°æ¥æº
- **é…ç½®æ–‡ä»¶**: `tradingagents/default_config.py` å®šä¹‰é»˜è®¤é…ç½®
- **ç³»ç»Ÿè¦†ç›–**: `tradingagents/utils/analysis_config.py` ä¸­çš„ `AnalysisConfigBuilder` ä»æŒä¹…åŒ–é…ç½®è¯»å–
- **å…³é”®å‚æ•°**:
  - `llm_provider`: LLM æä¾›å•†ï¼ˆopenai, dashscope, deepseek, google, anthropic, qianfan, openrouter, siliconflow, custom_openai ç­‰ï¼‰
  - `deep_think_llm`: æ·±åº¦æ€è€ƒæ¨¡å‹åç§°
  - `quick_think_llm`: å¿«é€Ÿæ€è€ƒæ¨¡å‹åç§°
  - `backend_url`: LLM åç«¯åœ°å€

### 1.2 LLM å®ä¾‹åˆ›å»º
**ä½ç½®**: `tradingagents/graph/trading_graph.py` (ç¬¬ 71-235 è¡Œ)

æ ¹æ® `config["llm_provider"]` åˆ›å»ºä¸¤ä¸ª LLM å®ä¾‹ï¼š
- `self.deep_thinking_llm`: ä½¿ç”¨ `config["deep_think_llm"]` æ¨¡å‹
- `self.quick_thinking_llm`: ä½¿ç”¨ `config["quick_think_llm"]` æ¨¡å‹

**æ”¯æŒçš„æä¾›å•†**:
- âœ… OpenAI
- âœ… SiliconFlow
- âœ… OpenRouter
- âœ… Ollama
- âœ… Anthropic
- âœ… Google
- âœ… DashScope (é˜¿é‡Œç™¾ç‚¼)
- âœ… DeepSeek
- âœ… Custom OpenAI
- âœ… Qianfan (ç™¾åº¦åƒå¸†)

**ç»“è®º**: âœ… **LLM åˆå§‹åŒ–æ­£ç¡®ä½¿ç”¨å…¨å±€é…ç½®å‚æ•°**

---

## 2. èŠ‚ç‚¹ LLM ä½¿ç”¨æƒ…å†µ

### 2.1 GraphSetup ä¸­çš„èŠ‚ç‚¹åˆ›å»º
**ä½ç½®**: `tradingagents/graph/setup.py`

æ‰€æœ‰èŠ‚ç‚¹åˆ›å»ºå‡½æ•°éƒ½æ¥æ”¶å¹¶ä½¿ç”¨äº†ä¼ å…¥çš„ LLM å‚æ•°ï¼š

#### åˆ†æå¸ˆèŠ‚ç‚¹ï¼ˆä½¿ç”¨ `quick_thinking_llm`ï¼‰
| èŠ‚ç‚¹ | åˆ›å»ºå‡½æ•° | LLM å‚æ•° | çŠ¶æ€ |
|------|---------|---------|------|
| Market Analyst | `create_market_analyst(self.quick_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| Social Media Analyst | `create_social_media_analyst(self.quick_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| News Analyst | `create_news_analyst(self.quick_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| Fundamentals Analyst | `create_fundamentals_analyst(self.quick_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |

#### ç ”ç©¶å‘˜èŠ‚ç‚¹ï¼ˆä½¿ç”¨ `quick_thinking_llm`ï¼‰
| èŠ‚ç‚¹ | åˆ›å»ºå‡½æ•° | LLM å‚æ•° | çŠ¶æ€ |
|------|---------|---------|------|
| Bull Researcher | `create_bull_researcher(self.quick_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| Bear Researcher | `create_bear_researcher(self.quick_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |

#### ç®¡ç†èŠ‚ç‚¹
| èŠ‚ç‚¹ | åˆ›å»ºå‡½æ•° | LLM å‚æ•° | çŠ¶æ€ |
|------|---------|---------|------|
| Research Manager | `create_research_manager(self.deep_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| Trader | `create_trader(self.quick_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| Risk Manager | `create_risk_manager(self.deep_thinking_llm, ...)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |

#### é£é™©åˆ†æèŠ‚ç‚¹ï¼ˆä½¿ç”¨ `quick_thinking_llm`ï¼‰
| èŠ‚ç‚¹ | åˆ›å»ºå‡½æ•° | LLM å‚æ•° | çŠ¶æ€ |
|------|---------|---------|------|
| Risky Analyst | `create_risky_debator(self.quick_thinking_llm)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| Neutral Analyst | `create_neutral_debator(self.quick_thinking_llm)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |
| Safe Analyst | `create_safe_debator(self.quick_thinking_llm)` | âœ… ä½¿ç”¨ | âœ… æ­£ç¡® |

**ç»“è®º**: âœ… **æ‰€æœ‰èŠ‚ç‚¹éƒ½æ­£ç¡®ä½¿ç”¨äº†ä¼ å…¥çš„ LLM å‚æ•°**

---

## 3. Agent èŠ‚ç‚¹å®ç°æ£€æŸ¥

### 3.1 èŠ‚ç‚¹å®ç°æ–‡ä»¶æ£€æŸ¥

æ£€æŸ¥äº†æ‰€æœ‰ agent èŠ‚ç‚¹çš„å®ç°ï¼Œç¡®è®¤å®ƒä»¬éƒ½ä½¿ç”¨ä¼ å…¥çš„ `llm` å‚æ•°ï¼š

#### âœ… æ­£ç¡®ä½¿ç”¨ä¼ å…¥ LLM çš„èŠ‚ç‚¹

1. **Market Analyst** (`tradingagents/agents/analysts/market_analyst.py`)
   - ä½¿ç”¨ `llm.bind_tools(tools)` å’Œ `llm.invoke()`
   - âœ… æ­£ç¡®

2. **Social Media Analyst** (`tradingagents/agents/analysts/social_media_analyst.py`)
   - ä½¿ç”¨ `llm.bind_tools(tools)` å’Œ `llm.invoke()`
   - âœ… æ­£ç¡®

3. **News Analyst** (`tradingagents/agents/analysts/news_analyst.py`)
   - ä½¿ç”¨ `llm.invoke()`
   - âœ… æ­£ç¡®

4. **Fundamentals Analyst** (`tradingagents/agents/analysts/fundamentals_analyst.py`)
   - ä½¿ç”¨ `llm.bind_tools(tools)` å’Œ `llm.invoke()`
   - âš ï¸ **ç‰¹æ®Šæƒ…å†µ**: æ£€æµ‹åˆ° DashScope æ¨¡å‹æ—¶ä¼šåˆ›å»ºæ–°å®ä¾‹ï¼Œä½†æ–°å®ä¾‹åŸºäºä¼ å…¥ `llm` çš„å‚æ•°ï¼ˆ`llm.model_name`, `llm.temperature` ç­‰ï¼‰ï¼Œæ‰€ä»¥ä»ç„¶éµå¾ªé…ç½®
   - âœ… æ­£ç¡®ï¼ˆç‰¹æ®Šæƒ…å†µå·²å¤„ç†ï¼‰

5. **Bull Researcher** (`tradingagents/agents/researchers/bull_researcher.py`)
   - ä½¿ç”¨ `llm.invoke(prompt)`
   - âœ… æ­£ç¡®

6. **Bear Researcher** (`tradingagents/agents/researchers/bear_researcher.py`)
   - ä½¿ç”¨ `llm.invoke(prompt)`
   - âœ… æ­£ç¡®

7. **Research Manager** (`tradingagents/agents/managers/research_manager.py`)
   - ä½¿ç”¨ `llm.invoke(prompt)`
   - âœ… æ­£ç¡®

8. **Trader** (`tradingagents/agents/trader/trader.py`)
   - ä½¿ç”¨ `llm.invoke(messages)`
   - âœ… æ­£ç¡®

9. **Risk Manager** (`tradingagents/agents/managers/risk_manager.py`)
   - ä½¿ç”¨ `llm.invoke(prompt)`
   - âœ… æ­£ç¡®

10. **Risky Analyst** (`tradingagents/agents/risk_mgmt/aggresive_debator.py`)
    - ä½¿ç”¨ `llm.invoke(prompt)`
    - âœ… æ­£ç¡®

11. **Neutral Analyst** (`tradingagents/agents/risk_mgmt/neutral_debator.py`)
    - ä½¿ç”¨ `llm.invoke(prompt)`
    - âœ… æ­£ç¡®

12. **Safe Analyst** (`tradingagents/agents/risk_mgmt/conservative_debator.py`)
    - ä½¿ç”¨ `llm.invoke(prompt)`
    - âœ… æ­£ç¡®

### 3.2 è¾…åŠ©ç»„ä»¶æ£€æŸ¥

1. **Reflector** (`tradingagents/graph/reflection.py`)
   - æ¥æ”¶ `quick_thinking_llm` å‚æ•°
   - ä½¿ç”¨ `self.quick_thinking_llm.invoke()`
   - âœ… æ­£ç¡®

2. **SignalProcessor** (`tradingagents/graph/signal_processing.py`)
   - æ¥æ”¶ `quick_thinking_llm` å‚æ•°
   - ä½¿ç”¨ `self.quick_thinking_llm.invoke()`
   - âœ… æ­£ç¡®

**ç»“è®º**: âœ… **æ‰€æœ‰èŠ‚ç‚¹å®ç°éƒ½æ­£ç¡®ä½¿ç”¨ä¼ å…¥çš„ LLM å‚æ•°ï¼Œæ²¡æœ‰ç¡¬ç¼–ç çš„ LLM åˆ›å»º**

---

## 4. ç‰¹æ®Šæƒ…å†µè¯´æ˜

### 4.1 Fundamentals Analyst ä¸­çš„ DashScope å¤„ç†
**ä½ç½®**: `tradingagents/agents/analysts/fundamentals_analyst.py` (ç¬¬ 241-251 è¡Œ)

```python
# æ£€æµ‹é˜¿é‡Œç™¾ç‚¼æ¨¡å‹å¹¶åˆ›å»ºæ–°å®ä¾‹
if hasattr(llm, '__class__') and 'DashScope' in llm.__class__.__name__:
    logger.debug(f"ğŸ“Š [DEBUG] æ£€æµ‹åˆ°é˜¿é‡Œç™¾ç‚¼æ¨¡å‹ï¼Œåˆ›å»ºæ–°å®ä¾‹ä»¥é¿å…å·¥å…·ç¼“å­˜")
    from tradingagents.llm_adapters import ChatDashScopeOpenAI
    fresh_llm = ChatDashScopeOpenAI(
        model=llm.model_name,      # âœ… ä½¿ç”¨ä¼ å…¥ LLM çš„æ¨¡å‹åç§°
        temperature=llm.temperature,  # âœ… ä½¿ç”¨ä¼ å…¥ LLM çš„æ¸©åº¦å‚æ•°
        max_tokens=getattr(llm, 'max_tokens', 2000)  # âœ… ä½¿ç”¨ä¼ å…¥ LLM çš„ max_tokens
    )
else:
    fresh_llm = llm
```

**è¯´æ˜**: è¿™æ˜¯ä¸ºäº†é¿å…å·¥å…·ç¼“å­˜é—®é¢˜è€Œåˆ›å»ºçš„æ–°å®ä¾‹ï¼Œä½†æ–°å®ä¾‹çš„å‚æ•°å®Œå…¨åŸºäºä¼ å…¥çš„ `llm`ï¼Œå› æ­¤ä»ç„¶éµå¾ªå…¨å±€é…ç½®ã€‚

**ç»“è®º**: âœ… **ç‰¹æ®Šæƒ…å†µå¤„ç†æ­£ç¡®ï¼Œä»ç„¶éµå¾ªå…¨å±€é…ç½®**

---

## 5. é…ç½®ä¼ é€’é“¾è·¯

```
å…¨å±€é…ç½® (config)
    â†“
TradingAgentsGraph.__init__()
    â”œâ”€ æ ¹æ® config["llm_provider"] åˆ›å»º deep_thinking_llm
    â””â”€ æ ¹æ® config["llm_provider"] åˆ›å»º quick_thinking_llm
        â†“
GraphSetup.__init__(quick_thinking_llm, deep_thinking_llm, ...)
        â†“
GraphSetup.setup_graph()
    â”œâ”€ create_market_analyst(quick_thinking_llm, ...)
    â”œâ”€ create_social_media_analyst(quick_thinking_llm, ...)
    â”œâ”€ create_news_analyst(quick_thinking_llm, ...)
    â”œâ”€ create_fundamentals_analyst(quick_thinking_llm, ...)
    â”œâ”€ create_bull_researcher(quick_thinking_llm, ...)
    â”œâ”€ create_bear_researcher(quick_thinking_llm, ...)
    â”œâ”€ create_research_manager(deep_thinking_llm, ...)
    â”œâ”€ create_trader(quick_thinking_llm, ...)
    â”œâ”€ create_risky_debator(quick_thinking_llm)
    â”œâ”€ create_neutral_debator(quick_thinking_llm)
    â”œâ”€ create_safe_debator(quick_thinking_llm)
    â””â”€ create_risk_manager(deep_thinking_llm, ...)
```

**ç»“è®º**: âœ… **é…ç½®ä¼ é€’é“¾è·¯å®Œæ•´ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½æ­£ç¡®è·å–åˆ°å…¨å±€é…ç½®çš„ LLM å®ä¾‹**

---

## 6. æ£€æŸ¥ç»“æœæ€»ç»“

### âœ… é€šè¿‡é¡¹
1. âœ… LLM åˆå§‹åŒ–æ­£ç¡®ä½¿ç”¨å…¨å±€é…ç½®å‚æ•°ï¼ˆ`llm_provider`ã€`deep_think_llm`ã€`quick_think_llm`ï¼‰
2. âœ… æ‰€æœ‰èŠ‚ç‚¹åˆ›å»ºå‡½æ•°éƒ½æ¥æ”¶å¹¶ä½¿ç”¨äº†ä¼ å…¥çš„ LLM å‚æ•°
3. âœ… æ‰€æœ‰èŠ‚ç‚¹å®ç°éƒ½ä½¿ç”¨ä¼ å…¥çš„ LLMï¼Œæ²¡æœ‰ç¡¬ç¼–ç åˆ›å»º LLM å®ä¾‹
4. âœ… ç‰¹æ®Šæƒ…å†µï¼ˆDashScope å·¥å…·ç¼“å­˜ï¼‰å¤„ç†æ­£ç¡®ï¼Œä»ç„¶éµå¾ªå…¨å±€é…ç½®
5. âœ… è¾…åŠ©ç»„ä»¶ï¼ˆReflectorã€SignalProcessorï¼‰ä¹Ÿæ­£ç¡®ä½¿ç”¨ä¼ å…¥çš„ LLM

### âš ï¸ æ³¨æ„äº‹é¡¹
1. **Fundamentals Analyst** åœ¨æ£€æµ‹åˆ° DashScope æ¨¡å‹æ—¶ä¼šåˆ›å»ºæ–°å®ä¾‹ï¼Œä½†æ–°å®ä¾‹å‚æ•°åŸºäºä¼ å…¥çš„ LLMï¼Œå› æ­¤ä»ç„¶éµå¾ªé…ç½®
2. æ‰€æœ‰èŠ‚ç‚¹éƒ½æ­£ç¡®åŒºåˆ†äº† `quick_thinking_llm` å’Œ `deep_thinking_llm` çš„ä½¿ç”¨åœºæ™¯

### ğŸ“Š ç»Ÿè®¡
- **æ€»èŠ‚ç‚¹æ•°**: 12 ä¸ªä¸»è¦èŠ‚ç‚¹ + 2 ä¸ªè¾…åŠ©ç»„ä»¶
- **æ­£ç¡®ä½¿ç”¨é…ç½®çš„èŠ‚ç‚¹**: 14/14 (100%)
- **ç¡¬ç¼–ç  LLM çš„èŠ‚ç‚¹**: 0/14 (0%)

---

## 7. æœ€ç»ˆç»“è®º

âœ… **æ‰€æœ‰ langgraph èŠ‚ç‚¹éƒ½æ­£ç¡®ä½¿ç”¨äº†å…¨å±€æ¨¡å‹é…ç½®å‚æ•°ï¼ˆ`llm_provider`ã€`deep_think_llm`ã€`quick_think_llm`ï¼‰æ¥é€‰æ‹©å¯¹åº”çš„æ¨¡å‹æœåŠ¡å¹³å°å’Œå¯¹åº”çš„æ¨¡å‹ã€‚**

**å»ºè®®**:
1. å½“å‰å®ç°å·²ç»éå¸¸å®Œå–„ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½æ­£ç¡®ä½¿ç”¨äº†å…¨å±€é…ç½®
2. å¯ä»¥ç»§ç»­ä¿æŒå½“å‰çš„å®ç°æ–¹å¼
3. å¦‚æœæœªæ¥éœ€è¦æ·»åŠ æ–°èŠ‚ç‚¹ï¼Œè¯·ç¡®ä¿éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼šæ¥æ”¶ LLM å‚æ•°å¹¶ä½¿ç”¨ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ›å»º LLM å®ä¾‹

---

## 8. é…ç½®æ›´æ–°æ¥å£æ£€æŸ¥

### 8.1 PUT /api/config/system æ¥å£å®ç°

**ä½ç½®**: `app/routers/config.py` (ç¬¬ 157-194 è¡Œ)

**æ¥å£åŠŸèƒ½**: æ›´æ–°ç³»ç»Ÿé…ç½®å¹¶æŒä¹…åŒ–åˆ°æ•°æ®åº“

**å®ç°æµç¨‹**:
```python
@router.put("/system", response_model=SystemConfigResponse)
async def update_system_config(request: UpdateSystemConfigRequest):
    # 1. è·å–è¯·æ±‚æ•°æ®
    incoming = request.model_dump(exclude_none=True)
    
    # 2. éªŒè¯é…ç½®ç±»å‹
    valid_keys = ['models', 'pricing', 'settings']
    provided_keys = [key for key in incoming.keys() if key in valid_keys]
    
    # 3. ä¿å­˜é…ç½®åˆ°æ•°æ®åº“ï¼ˆå…¨å±€æŒä¹…åŒ–ï¼‰
    config_manager.save_system_config(incoming)
    
    return SystemConfigResponse(success=True, data={}, message="ç³»ç»Ÿé…ç½®æ›´æ–°æˆåŠŸ")
```

**é…ç½®ä¿å­˜æµç¨‹** (`tradingagents/config/config_manager.py` ç¬¬ 342-377 è¡Œ):
1. `save_system_config()` æ¥æ”¶é…ç½®å­—å…¸
2. å¦‚æœåŒ…å« `settings`ï¼Œè°ƒç”¨ `save_settings()` 
3. `save_settings()` è°ƒç”¨ `system_config_manager.save_settings()` ä¿å­˜åˆ° MongoDB
4. é…ç½®æŒä¹…åŒ–åˆ°æ•°æ®åº“é›†åˆ `dict_settings`

**ç»“è®º**: âœ… **é…ç½®æ›´æ–°æ¥å£æ­£ç¡®ä¿å­˜åˆ°å…¨å±€æ•°æ®åº“**

---

### 8.2 é…ç½®è¯»å–æµç¨‹

**ä½ç½®**: `tradingagents/utils/analysis_config.py`

**é…ç½®è¯»å–æ—¶æœº**: æ¯æ¬¡åˆ›å»ºæ–°çš„åˆ†æä»»åŠ¡æ—¶

**è¯»å–æµç¨‹**:
```python
# 1. AnalysisConfigBuilder.build_config() è¢«è°ƒç”¨
config_builder = AnalysisConfigBuilder()
config = config_builder.build_config(research_depth=research_depth, market_type=market_type)

# 2. _load_system_overrides() ä»æ•°æ®åº“è¯»å–æœ€æ–°é…ç½®
def _load_system_overrides(self) -> Dict[str, Any]:
    config = config_manager.fetch_system_config(config_types=['settings'])
    overrides = config.get('settings', {})
    return overrides

# 3. é…ç½®åº”ç”¨åˆ° DEFAULT_CONFIG
config = DEFAULT_CONFIG.copy()
config.update({k: v for k, v in system_overrides.items() if k != "db"})

# 4. LLM é…ç½®è¢«æå–
effective_llm_provider = system_overrides.get("llm_provider")
effective_llm_model = system_overrides.get("deep_think_llm")
effective_quick_model = system_overrides.get("quick_think_llm")

# 5. é…ç½®ä¼ é€’ç»™ TradingAgentsGraph
graph = TradingAgentsGraph(analysts, config=config, debug=False)
```

**ç»“è®º**: âœ… **æ¯æ¬¡åˆ›å»ºæ–°åˆ†æä»»åŠ¡æ—¶éƒ½ä¼šä»æ•°æ®åº“è¯»å–æœ€æ–°é…ç½®**

---

### 8.3 TradingAgentsGraph å®ä¾‹åˆ›å»º

**ä½ç½®**: `tradingagents/graph/trading_graph.py` (ç¬¬ 45-235 è¡Œ)

**å®ä¾‹åˆ›å»ºæµç¨‹**:
```python
def __init__(self, selected_analysts, debug=False, config: Dict[str, Any] = None):
    # 1. ä½¿ç”¨ä¼ å…¥çš„ configï¼ˆæ¥è‡ª AnalysisConfigBuilderï¼‰
    self.config = config or DEFAULT_CONFIG
    
    # 2. æ ¹æ® config ä¸­çš„ llm_providerã€deep_think_llmã€quick_think_llm åˆ›å»º LLM å®ä¾‹
    if self.config["llm_provider"].lower() == "openai":
        self.deep_thinking_llm = ChatOpenAI(model=self.config["deep_think_llm"], ...)
        self.quick_thinking_llm = ChatOpenAI(model=self.config["quick_think_llm"], ...)
    elif self.config["llm_provider"].lower() == "dashscope":
        # ... å…¶ä»–æä¾›å•†
    # ...
    
    # 3. LLM å®ä¾‹ä¼ é€’ç»™ GraphSetup
    self.graph_setup = GraphSetup(
        self.quick_thinking_llm,  # âœ… ä½¿ç”¨é…ç½®çš„ quick_think_llm
        self.deep_thinking_llm,   # âœ… ä½¿ç”¨é…ç½®çš„ deep_think_llm
        ...
    )
```

**ç»“è®º**: âœ… **TradingAgentsGraph å®ä¾‹åˆ›å»ºæ—¶ä½¿ç”¨ä¼ å…¥çš„é…ç½®å‚æ•°åˆ›å»º LLM**

---

### 8.4 é…ç½®æ›´æ–°å¯¹è¿è¡Œä¸­ä»»åŠ¡çš„å½±å“

**å…³é”®å‘ç°**:

1. **é…ç½®æ›´æ–°ä¼šç«‹å³ä¿å­˜åˆ°æ•°æ®åº“** âœ…
   - PUT /api/config/system æ¥å£è°ƒç”¨åï¼Œé…ç½®ç«‹å³ä¿å­˜åˆ° MongoDB
   - é…ç½®æŒä¹…åŒ–ï¼Œä¸ä¼šä¸¢å¤±

2. **æ–°åˆ†æä»»åŠ¡ä¼šä½¿ç”¨æœ€æ–°é…ç½®** âœ…
   - æ¯æ¬¡åˆ›å»ºæ–°åˆ†æä»»åŠ¡æ—¶ï¼Œ`AnalysisConfigBuilder.build_config()` éƒ½ä¼šä»æ•°æ®åº“è¯»å–æœ€æ–°é…ç½®
   - æ–°çš„ `TradingAgentsGraph` å®ä¾‹ä¼šä½¿ç”¨æœ€æ–°é…ç½®åˆ›å»º LLM

3. **æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¸å—å½±å“** âš ï¸
   - å·²ç»åˆ›å»ºçš„ `TradingAgentsGraph` å®ä¾‹å·²ç»åˆå§‹åŒ–äº† LLM
   - æ­£åœ¨è¿è¡Œçš„åˆ†æä»»åŠ¡ä¼šç»§ç»­ä½¿ç”¨åˆ›å»ºæ—¶çš„é…ç½®
   - è¿™æ˜¯**æ­£å¸¸ä¸”é¢„æœŸçš„è¡Œä¸º**ï¼Œå› ä¸ºï¼š
     - æ¯ä¸ªåˆ†æä»»åŠ¡åº”è¯¥åœ¨ä¸€è‡´çš„é…ç½®ä¸‹å®Œæˆ
     - é¿å…ä¸­é€”åˆ‡æ¢é…ç½®å¯¼è‡´åˆ†æç»“æœä¸ä¸€è‡´
     - æ–°ä»»åŠ¡ä¼šè‡ªåŠ¨ä½¿ç”¨æœ€æ–°é…ç½®

**ç»“è®º**: âœ… **é…ç½®æ›´æ–°æœºåˆ¶æ­£ç¡®ï¼Œæ–°ä»»åŠ¡ä¼šä½¿ç”¨æœ€æ–°é…ç½®ï¼Œæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¿æŒä¸€è‡´æ€§**

---

### 8.5 é…ç½®ä¼ é€’é“¾è·¯ï¼ˆå®Œæ•´æµç¨‹ï¼‰

```
ç”¨æˆ·é€šè¿‡ Web ç•Œé¢æ›´æ–°é…ç½®
    â†“
PUT /api/config/system
    â†“
config_manager.save_system_config()
    â†“
system_config_manager.save_settings() â†’ MongoDB (dict_settings é›†åˆ)
    â†“
[é…ç½®å·²æŒä¹…åŒ–åˆ°æ•°æ®åº“]
    â†“
[ç”¨æˆ·åˆ›å»ºæ–°çš„åˆ†æä»»åŠ¡]
    â†“
AnalysisConfigBuilder.build_config()
    â†“
_load_system_overrides() â†’ config_manager.fetch_system_config() â†’ MongoDB
    â†“
[è¯»å–æœ€æ–°é…ç½®]
    â†“
config.update(system_overrides) â†’ åº”ç”¨é…ç½®è¦†ç›–
    â†“
TradingAgentsGraph.__init__(config=config)
    â†“
æ ¹æ® config["llm_provider"]ã€config["deep_think_llm"]ã€config["quick_think_llm"] åˆ›å»º LLM
    â†“
GraphSetup(quick_thinking_llm, deep_thinking_llm, ...)
    â†“
æ‰€æœ‰èŠ‚ç‚¹ä½¿ç”¨ä¼ å…¥çš„ LLM å®ä¾‹
```

**ç»“è®º**: âœ… **é…ç½®ä¼ é€’é“¾è·¯å®Œæ•´ï¼Œä»æ•°æ®åº“è¯»å–åˆ°èŠ‚ç‚¹ä½¿ç”¨ï¼Œå…¨ç¨‹ä½¿ç”¨å…¨å±€é…ç½®**

---

### 8.6 é…ç½®æ›´æ–°æ¥å£æ£€æŸ¥æ€»ç»“

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| é…ç½®æ›´æ–°ä¿å­˜åˆ°æ•°æ®åº“ | âœ… | PUT /api/config/system æ­£ç¡®ä¿å­˜åˆ° MongoDB |
| é…ç½®æŒä¹…åŒ– | âœ… | é…ç½®ä¿å­˜åœ¨ `dict_settings` é›†åˆä¸­ |
| æ–°ä»»åŠ¡è¯»å–æœ€æ–°é…ç½® | âœ… | æ¯æ¬¡åˆ›å»ºæ–°ä»»åŠ¡æ—¶ä»æ•°æ®åº“è¯»å–æœ€æ–°é…ç½® |
| LLM å®ä¾‹ä½¿ç”¨é…ç½® | âœ… | TradingAgentsGraph ä½¿ç”¨é…ç½®åˆ›å»º LLM å®ä¾‹ |
| èŠ‚ç‚¹ä½¿ç”¨é…ç½®çš„ LLM | âœ… | æ‰€æœ‰èŠ‚ç‚¹ä½¿ç”¨ä¼ å…¥çš„ LLM å®ä¾‹ |
| æ­£åœ¨è¿è¡Œä»»åŠ¡çš„å½±å“ | âš ï¸ | æ­£å¸¸è¡Œä¸ºï¼šæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¿æŒåˆ›å»ºæ—¶çš„é…ç½® |

**æœ€ç»ˆç»“è®º**: âœ… **PUT /api/config/system æ¥å£æ›´æ–°æ¨¡å‹é…ç½®åï¼Œé…ç½®ä¼šä¿å­˜åˆ°å…¨å±€æ•°æ®åº“ï¼Œæ–°çš„åˆ†æä»»åŠ¡ä¼šä½¿ç”¨æœ€æ–°é…ç½®ï¼Œæ‰€æœ‰èŠ‚ç‚¹åœ¨è°ƒç”¨æ¨¡å‹æ—¶éƒ½ä½¿ç”¨çš„æ˜¯å…¨å±€é…ç½®å‚æ•°ã€‚**

---

## 9. ç›¸å…³æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒæ–‡ä»¶
- `tradingagents/graph/trading_graph.py` - LLM åˆå§‹åŒ–å’Œå›¾åˆ›å»º
- `tradingagents/graph/setup.py` - èŠ‚ç‚¹åˆ›å»ºå’Œé…ç½®
- `tradingagents/utils/analysis_config.py` - é…ç½®æ„å»ºå™¨
- `tradingagents/default_config.py` - é»˜è®¤é…ç½®

### é…ç½®ç®¡ç†æ–‡ä»¶
- `app/routers/config.py` - é…ç½®ç®¡ç† API æ¥å£
- `tradingagents/config/config_manager.py` - é…ç½®ç®¡ç†å™¨
- `tradingagents/storage/mongodb/system_config_manager.py` - ç³»ç»Ÿé…ç½® MongoDB ç®¡ç†å™¨

### Agent èŠ‚ç‚¹æ–‡ä»¶
- `tradingagents/agents/analysts/market_analyst.py`
- `tradingagents/agents/analysts/social_media_analyst.py`
- `tradingagents/agents/analysts/news_analyst.py`
- `tradingagents/agents/analysts/fundamentals_analyst.py`
- `tradingagents/agents/researchers/bull_researcher.py`
- `tradingagents/agents/researchers/bear_researcher.py`
- `tradingagents/agents/managers/research_manager.py`
- `tradingagents/agents/trader/trader.py`
- `tradingagents/agents/managers/risk_manager.py`
- `tradingagents/agents/risk_mgmt/aggresive_debator.py`
- `tradingagents/agents/risk_mgmt/neutral_debator.py`
- `tradingagents/agents/risk_mgmt/conservative_debator.py`

### è¾…åŠ©ç»„ä»¶
- `tradingagents/graph/reflection.py`
- `tradingagents/graph/signal_processing.py`

