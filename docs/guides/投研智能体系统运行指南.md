# Vue 前端与 FastAPI 后端实现演示指南

本文档介绍了基于 Vue.js 重新开发的股票分析前端，以及封装在 FastAPI 服务中的后端逻辑。

## 已实施的变更

### 后端 (`app/`)
- **新路由**: 创建了 `app/routers/analysis.py` 来处理股票分析请求。
    - `POST /api/analysis/start`: 启动新的分析任务。
    - `GET /api/analysis/{analysis_id}/status`: 检查运行中任务的状态。
    - `GET /api/analysis/{analysis_id}/result`: 获取最终报告。
- **主应用程序**: 更新了 `app/main.py` 以包含新路由并配置 CORS，允许来自 Vue 前端 (`http://localhost:5173`) 的请求。
- **配置**: 在 `.env` 中添加了 `JWT_SECRET` 以修复启动问题。

### 前端 (`frontend/`)
- **项目初始化**: 使用 Vite 创建了一个新的 Vue 3 + TypeScript 项目。
- **样式**: 配置了 Tailwind CSS 以实现现代、响应式的样式。
- **API 客户端**: 实现了 `src/api/index.ts` 以与 FastAPI 后端交互。
- **UI 组件**:
    - `src/views/HomeView.vue`: 主界面，复制了原始 Streamlit 表单，具有高端设计。它处理用户输入，显示实时进度日志，并渲染最终的 Markdown 报告。
    - `src/App.vue`: 根组件。

## 环境准备

### 后端环境配置

#### 1. Python 环境要求
- Python 3.8 或更高版本
- 推荐使用虚拟环境管理依赖

#### 2. 安装后端依赖（方法一：使用 pip）
在项目根目录下执行以下命令：

```bash
# 创建虚拟环境（如果尚未创建）
python -m venv .venv

# 激活虚拟环境
# Windows PowerShell:
.venv\Scripts\Activate.ps1
# Windows CMD:
.venv\Scripts\activate.bat
# Linux/macOS:
source .venv/bin/activate

# 安装项目依赖
pip install -e .
# 或者使用 requirements.txt
pip install -r requirements.txt
```

#### 2. 安装后端依赖（方法二：使用 uv）
[uv](https://github.com/astral-sh/uv) 是一个极快的 Python 包管理器，推荐使用以提升安装速度。

```bash
# 安装 uv（如果尚未安装）
# Windows PowerShell:
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
# Linux/macOS:
curl -LsSf https://astral.sh/uv/install.sh | sh

# 使用 uv 同步依赖（会自动创建虚拟环境）
uv sync

# 激活虚拟环境
# Windows PowerShell:
.venv\Scripts\Activate.ps1
# Windows CMD:
.venv\Scripts\activate.bat
# Linux/macOS:
source .venv/bin/activate
```


#### 3. 配置环境变量
复制 `.env.example` 文件并重命名为 `.env`，然后配置必要的环境变量：

```bash
cp .env.example .env
```

确保 `.env` 文件中包含以下必需配置：
- `JWT_SECRET`: JWT 密钥（可以使用任意随机字符串）
- `DASHSCOPE_API_KEY`: 阿里云 DashScope API 密钥
- `FINNHUB_API_KEY`: Finnhub API 密钥

### 前端环境配置

#### 1. Node.js 环境要求
- Node.js 16.x 或更高版本
- npm 或 yarn 包管理器

#### 2. 安装前端依赖
在 `frontend` 目录下执行以下命令：

```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install
# 或使用 yarn
yarn install
```

## 如何运行

### 1. 启动后端
在根目录 (`e:\Develop\AI-Agents\TradingAgents`) 打开终端并运行：
```bash
.venv\Scripts\python -m uvicorn app.main:app --reload --port 8000
```
API 将在 `http://localhost:8000` 上可用。

### 2. 启动前端
在 `frontend` 目录 (`e:\Develop\AI-Agents\TradingAgents\frontend`) 打开新终端并运行：
```bash
# 确保已在 frontend 目录下
cd frontend

# 启动开发服务器
npm run dev
```
Web 应用程序将在 `http://localhost:5173` 上可用。

### 3. 停止服务
在运行服务的终端窗口中，按下 `Ctrl+C` 组合键即可停止后端或前端服务。如果是通过脚本启动的，关闭终端窗口通常也会停止服务。

## 验证结果
- **后端启动**: 确认 FastAPI 服务器成功启动并提供新端点。
- **前端启动**: 确认 Vite 开发服务器启动并提供 Vue 应用程序。
- **集成**: 前端配置为与 `http://localhost:8000/api` 的后端通信。

## 下一步
- **测试**: 通过在新前端上运行分析来执行完整的端到端测试。
- **优化**: 根据用户反馈优化 UI/UX。
- **部署**: 为生产环境构建前端，并通过 FastAPI 或单独的 Web 服务器提供服务。
