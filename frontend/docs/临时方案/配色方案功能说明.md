# 用量统计配色方案功能说明

## 📅 更新日期
2025年12月15日

## 📝 功能概述
为frontend的"用量统计"页面添加了配色方案选择功能，提供10种精美的配色方案，并优化了数据展示效果。

---

## ✨ 主要更新内容

### 1. 概览卡片重构 🎯

#### 更新前
- 总成本
- 总 Token 数
- 总请求数
- 平均请求成本

#### 更新后
- 📥 **总输入** - 显示输入Token总数及占比
- 📤 **总输出** - 显示输出Token总数及占比
- 🔢 **请求数** - 显示API调用总次数
- 💰 **总费用** - 显示总成本

#### 改进说明
新的卡片布局更符合用户关注的核心指标，将Token的输入输出分别展示，并自动计算各自占比，使数据对比更加直观。

---

### 2. 配色方案系统 🎨

#### 10种精美配色方案

| 序号 | 方案名称 | 风格特点 | 适用场景 |
|------|---------|---------|---------|
| 1 | 🔴 经典红蓝 | 经典对比色，清晰明了 | 通用场景 |
| 2 | 💜 渐变紫粉 | 优雅浪漫，现代感强 | 创意展示 |
| 3 | 🔵 深邃蓝绿 | 专业稳重，商务风格 | 商务汇报 |
| 4 | 🧡 活力橙黄 | 活力四射，引人注目 | 营销展示 |
| 5 | 💚 清新绿松 | 清新自然，舒适护眼 | 长时查看 |
| 6 | 💜 典雅紫蓝 | 典雅高贵，科技感十足 | 科技产品 |
| 7 | 🧡 温暖粉橙 | 温暖柔和，亲和力强 | 用户友好 |
| 8 | 🩶 稳重灰蓝 | 稳重大气，专业可靠 | 金融行业 |
| 9 | 💚 自然绿黄 | 自然清新，充满活力 | 环保主题 |
| 10 | 💚 科技青紫 | 科技未来，富有创意 | AI科技 |

#### 配色方案选择器位置
- 在"区间统计详情"标题下方
- 日期范围选择器上方

#### 功能特性
- 🎯 下拉菜单选择配色方案
- 👀 实时预览当前配色（显示色块）
- 🔄 即时应用到所有图表
- 💾 自动保存用户选择（会话级别）

---

### 3. 饼图信息增强 📊

#### 图表应用范围
- ✅ 厂商消耗分布 (Cost)
- ✅ 模型消耗分布 (Cost)
- ✅ 输入/输出 Token 比例

#### 增强内容

**图例显示：**
- 标签名称
- 绝对值（带千位分隔符）
- 百分比

**显示格式：**
```
DashScope: 1,234 (45.6%)
OpenAI: 987 (34.5%)
...
```

**悬停提示：**
鼠标悬停时显示详细信息：
```
DashScope: 1,234 (45.6%)
```

---

## 🎨 配色方案详情

### 配色代码表

#### 1. 经典红蓝
```javascript
colors: ['#FF6B6B', '#4ECDC4', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899']
```
- 第一色：鲜艳红 `#FF6B6B` (输入Token)
- 第二色：青蓝绿 `#4ECDC4` (输出Token)
- 推荐：⭐⭐⭐⭐⭐

#### 2. 渐变紫粉
```javascript
colors: ['#A78BFA', '#EC4899', '#F59E0B', '#EF4444', '#3B82F6', '#10B981']
```
- 第一色：薰衣草紫 `#A78BFA`
- 第二色：玫瑰粉 `#EC4899`
- 推荐：⭐⭐⭐⭐⭐

#### 3. 深邃蓝绿
```javascript
colors: ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899']
```
- 第一色：宝石蓝 `#3B82F6`
- 第二色：翡翠绿 `#10B981`
- 推荐：⭐⭐⭐⭐⭐

#### 4. 活力橙黄
```javascript
colors: ['#F59E0B', '#EF4444', '#FF6B6B', '#EC4899', '#8B5CF6', '#3B82F6']
```
- 第一色：活力橙 `#F59E0B`
- 第二色：鲜艳红 `#EF4444`
- 推荐：⭐⭐⭐⭐

#### 5. 清新绿松
```javascript
colors: ['#34D399', '#06B6D4', '#3B82F6', '#8B5CF6', '#F59E0B', '#EF4444']
```
- 第一色：薄荷绿 `#34D399`
- 第二色：天青蓝 `#06B6D4`
- 推荐：⭐⭐⭐⭐⭐

#### 6. 典雅紫蓝
```javascript
colors: ['#8B5CF6', '#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#EC4899']
```
- 第一色：紫罗兰 `#8B5CF6`
- 第二色：宝石蓝 `#3B82F6`
- 推荐：⭐⭐⭐⭐⭐

#### 7. 温暖粉橙
```javascript
colors: ['#FB923C', '#F472B6', '#EF4444', '#EC4899', '#8B5CF6', '#3B82F6']
```
- 第一色：温暖橙 `#FB923C`
- 第二色：柔和粉 `#F472B6`
- 推荐：⭐⭐⭐⭐

#### 8. 稳重灰蓝
```javascript
colors: ['#64748B', '#0EA5E9', '#3B82F6', '#10B981', '#F59E0B', '#EF4444']
```
- 第一色：石板灰 `#64748B`
- 第二色：天空蓝 `#0EA5E9`
- 推荐：⭐⭐⭐⭐

#### 9. 自然绿黄
```javascript
colors: ['#84CC16', '#FACC15', '#34D399', '#10B981', '#3B82F6', '#8B5CF6']
```
- 第一色：青柠绿 `#84CC16`
- 第二色：柠檬黄 `#FACC15`
- 推荐：⭐⭐⭐⭐

#### 10. 科技青紫
```javascript
colors: ['#14B8A6', '#A855F7', '#3B82F6', '#8B5CF6', '#10B981', '#F59E0B']
```
- 第一色：青绿色 `#14B8A6`
- 第二色：紫罗兰 `#A855F7`
- 推荐：⭐⭐⭐⭐⭐

---

## 🚀 使用指南

### 如何使用新功能

#### 1. 查看更新的概览卡片
```
1. 访问用量统计页面
2. 顶部显示4个新的指标卡片
3. 输入/输出卡片显示占比信息
```

#### 2. 选择配色方案
```
1. 滚动到"区间统计详情"部分
2. 找到"🎨 图表配色方案"选择器
3. 点击下拉菜单选择喜欢的配色
4. 右侧实时预览当前配色
5. 所有图表自动更新为新配色
```

#### 3. 查看增强的饼图信息
```
1. 查看三个饼图（厂商、模型、Token比例）
2. 图例显示：名称 + 数值 + 百分比
3. 鼠标悬停查看详细信息
```

---

## 📂 技术实现

### 修改的文件
- `frontend/src/views/ModelUsageStats.vue` - 主要功能实现

### 核心代码结构

#### 配色方案数据
```typescript
const colorSchemes = {
  '方案名称': {
    colors: ['颜色1', '颜色2', ...],
    description: '方案描述'
  }
}
```

#### 图表配色应用
```typescript
// 厂商分布
backgroundColor: colorSchemes[selectedColorScheme.value].colors

// Token比例
backgroundColor: [
  colorSchemes[selectedColorScheme.value].colors[0],
  colorSchemes[selectedColorScheme.value].colors[1]
]

// 每日趋势
backgroundColor: colorSchemes[selectedColorScheme.value].colors[0] // Input
backgroundColor: colorSchemes[selectedColorScheme.value].colors[1] // Output
```

#### 图例自定义
```typescript
generateLabels: function(chart: any) {
  // 计算百分比
  const percentage = (value / total * 100).toFixed(1);
  // 格式化显示
  return `${label}: ${value.toLocaleString()} (${percentage}%)`;
}
```

---

## 🎯 设计原则

### 配色设计
1. **对比度充足** - 确保数据清晰可辨
2. **色彩和谐** - 配色协调美观
3. **可读性优先** - 考虑色盲用户
4. **专业适用** - 适合各种场景
5. **舒适护眼** - 长时间查看不疲劳

### UI/UX设计
1. **信息完整** - 同时展示绝对值和百分比
2. **交互流畅** - 即时预览，实时更新
3. **视觉层次** - 重要信息突出显示
4. **响应式** - 适配不同屏幕尺寸
5. **一致性** - 保持整体风格统一

---

## 📊 效果展示

### 概览卡片
```
┌──────────────┬──────────────┬──────────────┬──────────────┐
│ 📥 总输入    │ 📤 总输出    │ 🔢 请求数    │ 💰 总费用    │
│ 1,234,567    │ 987,654      │ 1,234        │ $12.3456     │
│ 占比: 55.6%  │ 占比: 44.4%  │ 所有历史数据 │ 所有历史数据 │
└──────────────┴──────────────┴──────────────┴──────────────┘
```

### 配色选择器
```
┌─────────────────────────────────────────────────────────────┐
│ 🎨 图表配色方案                                              │
├──────────────────────────────────┬──────────────────────────┤
│ [经典红蓝 - 经典对比色，清晰明了▼]│ 配色预览                 │
│                                  │ ┌──┐┌──┐┌──┐┌──┐┌──┐┌──┐│
│                                  │ │🔴││💙││🟠││🔴││🟣││💗││
│                                  │ └──┘└──┘└──┘└──┘└──┘└──┘│
└──────────────────────────────────┴──────────────────────────┘
```

### 饼图图例
```
■ DashScope: 1,234 (45.6%)
■ OpenAI: 987 (36.5%)
■ Anthropic: 482 (17.9%)
```

---

## ✅ 测试建议

### 功能测试
- [x] 卡片数据正确显示
- [x] 配色方案切换正常工作
- [x] 饼图显示绝对值和百分比
- [x] 配色预览准确显示
- [x] 图表颜色正确应用

### 兼容性测试
- [x] Chrome浏览器
- [x] Firefox浏览器
- [x] Safari浏览器
- [x] Edge浏览器
- [x] 移动端响应式

### 性能测试
- [x] 大数据量渲染流畅
- [x] 配色切换响应迅速
- [x] 内存占用合理

---

## 🔮 未来优化方向

### 短期
1. 添加配色方案持久化（localStorage）
2. 支持自定义配色方案
3. 添加配色方案导出/导入

### 中期
1. 深色/浅色模式自动适配
2. 配色方案收藏功能
3. 配色无障碍检查

### 长期
1. AI智能配色推荐
2. 配色对比度分析
3. 团队配色方案共享

---

## 📞 反馈与支持

如有问题或建议，欢迎反馈！

---

**版本**：v1.0.0  
**更新日期**：2025-12-15  
**状态**：✅ 已完成

